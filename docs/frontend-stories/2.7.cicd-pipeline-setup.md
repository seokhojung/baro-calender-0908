# Story 2.7: CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ Î∞è Î∞∞Ìè¨ ÏûêÎèôÌôî

## üìã Î¨∏ÏÑú Ï†ïÎ≥¥
- **Ïä§ÌÜ†Î¶¨ Î≤ÑÏ†Ñ**: 2.0
- **ÏûëÏÑ±Ïùº**: 2025-08-28
- **ÏûëÏÑ±Ïûê**: Bob (Scrum Master Agent)  
- **ÌîÑÎ°úÏ†ùÌä∏Î™Ö**: Î∞îÎ°úÏ∫òÎ¶∞Îçî (Baro Calendar)
- **Epic**: ÌîÑÎ°†Ìä∏ÏóîÎìú Î∞∞Ìè¨ ÏûêÎèôÌôî
- **ÏÉÅÌÉú**: Ready for Development

---

## üéØ **Ïä§ÌÜ†Î¶¨ Î™©Ìëú**

**ÏôÑÏ†ÑÌïú CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ Î∞è Î∞∞Ìè¨ ÏûêÎèôÌôî**
- GitHub Actions Í∏∞Î∞ò CI/CD Íµ¨ÌòÑ
- Îã§Ï§ë ÌôòÍ≤Ω Î∞∞Ìè¨ Ï†ÑÎûµ (dev/staging/prod)
- ÏûêÎèôÌôîÎêú ÌíàÏßà Í≤ÄÏ¶ù (ÌÖåÏä§Ìä∏, Î¶∞Ìä∏, ÌÉÄÏûÖ Í≤ÄÏÇ¨)
- ÏÑ±Îä• Í≤åÏù¥Ìä∏ Î∞è Î≥¥Ïïà Ïä§Ï∫î
- Î°§Î∞± Î∞è Î¨¥Ï§ëÎã® Î∞∞Ìè¨

---

## üë§ **ÏÇ¨Ïö©Ïûê Ïä§ÌÜ†Î¶¨**

**Í∞úÎ∞úÌåÄÏúºÎ°úÏÑú, Ïö∞Î¶¨Îäî:**
1. ÏΩîÎìú Ìë∏Ïãú Ïãú ÏûêÎèôÏúºÎ°ú Î™®Îì† Í≤ÄÏ¶ùÏù¥ Ïã§ÌñâÎêòÍ∏∞Î•º ÏõêÌïúÎã§
2. ÌÖåÏä§Ìä∏ Ïã§Ìå® Ïãú Î∞∞Ìè¨Í∞Ä ÏûêÎèôÏúºÎ°ú Ï∞®Îã®ÎêòÍ∏∞Î•º ÏõêÌïúÎã§
3. Ïä§ÌÖåÏù¥ÏßïÏóêÏÑú Í≤ÄÏ¶ù ÌõÑ ÌîÑÎ°úÎçïÏÖòÏóê ÏïàÏ†ÑÌïòÍ≤å Î∞∞Ìè¨ÌïòÍ≥† Ïã∂Îã§
4. Î¨∏Ï†ú Î∞úÏÉù Ïãú Îπ†Î•¥Í≤å Ïù¥Ï†Ñ Î≤ÑÏ†ÑÏúºÎ°ú Î°§Î∞±ÌïòÍ≥† Ïã∂Îã§
5. Î∞∞Ìè¨ ÏÉÅÌÉúÏôÄ Î©îÌä∏Î¶≠ÏùÑ Ïã§ÏãúÍ∞ÑÏúºÎ°ú Î™®ÎãàÌÑ∞ÎßÅÌïòÍ≥† Ïã∂Îã§

---

## üèóÔ∏è **Í∏∞Ïà†Ï†Å Íµ¨ÌòÑ ÏöîÍµ¨ÏÇ¨Ìï≠**

### **1. GitHub Actions ÏõåÌÅ¨ÌîåÎ°úÏö∞**

**Î©îÏù∏ CI/CD ÌååÏù¥ÌîÑÎùºÏù∏**
```yaml
# .github/workflows/ci-cd.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]
  release:
    types: [published]

env:
  NODE_VERSION: '18'
  REGISTRY: ghcr.io
  IMAGE_NAME: ${{ github.repository }}

jobs:
  # ÏùòÏ°¥ÏÑ± Î∞è Ï∫êÏãú ÏÑ§Ï†ï
  setup:
    runs-on: ubuntu-latest
    outputs:
      cache-key: ${{ steps.cache-key.outputs.key }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}

      - name: Generate cache key
        id: cache-key
        run: echo "key=node-modules-${{ hashFiles('**/package-lock.json') }}" >> $GITHUB_OUTPUT

      - name: Cache dependencies
        uses: actions/cache@v3
        with:
          path: ~/.npm
          key: ${{ steps.cache-key.outputs.key }}
          restore-keys: |
            node-modules-

      - name: Install dependencies
        run: npm ci

  # ÏΩîÎìú ÌíàÏßà Í≤ÄÏ¶ù
  code-quality:
    needs: setup
    runs-on: ubuntu-latest
    strategy:
      matrix:
        check: [lint, typecheck, format]
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}

      - name: Cache dependencies
        uses: actions/cache@v3
        with:
          path: ~/.npm
          key: ${{ needs.setup.outputs.cache-key }}

      - name: Install dependencies
        run: npm ci

      - name: Run ESLint
        if: matrix.check == 'lint'
        run: |
          npm run lint -- --format=json --output-file=eslint-results.json
          npm run lint

      - name: Run TypeScript check
        if: matrix.check == 'typecheck'
        run: npm run type-check

      - name: Check formatting
        if: matrix.check == 'format'
        run: npm run format:check

      - name: Upload lint results
        if: matrix.check == 'lint' && always()
        uses: actions/upload-artifact@v3
        with:
          name: lint-results
          path: eslint-results.json

  # Îã®ÏúÑ ÌÖåÏä§Ìä∏
  unit-tests:
    needs: setup
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}

      - name: Cache dependencies
        uses: actions/cache@v3
        with:
          path: ~/.npm
          key: ${{ needs.setup.outputs.cache-key }}

      - name: Install dependencies
        run: npm ci

      - name: Run unit tests
        run: |
          npm run test -- --coverage --watchAll=false --passWithNoTests
        env:
          CI: true

      - name: Upload coverage to Codecov
        uses: codecov/codecov-action@v3
        with:
          token: ${{ secrets.CODECOV_TOKEN }}
          file: ./coverage/lcov.info
          fail_ci_if_error: false

      - name: Upload test results
        uses: actions/upload-artifact@v3
        if: always()
        with:
          name: test-results
          path: |
            coverage/
            test-results.xml

  # Ï†ëÍ∑ºÏÑ± ÌÖåÏä§Ìä∏
  accessibility-tests:
    needs: setup
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}

      - name: Cache dependencies
        uses: actions/cache@v3
        with:
          path: ~/.npm
          key: ${{ needs.setup.outputs.cache-key }}

      - name: Install dependencies
        run: npm ci

      - name: Run accessibility tests
        run: npm run test:a11y

      - name: Upload a11y results
        uses: actions/upload-artifact@v3
        if: always()
        with:
          name: a11y-results
          path: a11y-results.json

  # E2E ÌÖåÏä§Ìä∏
  e2e-tests:
    needs: [setup, unit-tests]
    runs-on: ubuntu-latest
    strategy:
      matrix:
        browser: [chromium, firefox, webkit]
        shard: [1/4, 2/4, 3/4, 4/4]
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}

      - name: Cache dependencies
        uses: actions/cache@v3
        with:
          path: ~/.npm
          key: ${{ needs.setup.outputs.cache-key }}

      - name: Install dependencies
        run: npm ci

      - name: Install Playwright
        run: npx playwright install ${{ matrix.browser }}

      - name: Build application
        run: npm run build

      - name: Run E2E tests
        run: npx playwright test --project=${{ matrix.browser }} --shard=${{ matrix.shard }}
        env:
          PLAYWRIGHT_HTML_REPORT: playwright-report-${{ matrix.browser }}-${{ matrix.shard }}

      - name: Upload Playwright report
        uses: actions/upload-artifact@v3
        if: always()
        with:
          name: playwright-report-${{ matrix.browser }}-${{ matrix.shard }}
          path: playwright-report-${{ matrix.browser }}-${{ matrix.shard }}/

  # Î≥¥Ïïà Ïä§Ï∫î
  security-scan:
    needs: setup
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Run Trivy vulnerability scanner
        uses: aquasecurity/trivy-action@master
        with:
          scan-type: 'fs'
          scan-ref: '.'
          format: 'sarif'
          output: 'trivy-results.sarif'

      - name: Upload Trivy scan results to GitHub Security tab
        uses: github/codeql-action/upload-sarif@v3
        if: always()
        with:
          sarif_file: 'trivy-results.sarif'

      - name: Run Snyk to check for vulnerabilities
        uses: snyk/actions/node@master
        env:
          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
        with:
          args: --severity-threshold=high --file=package.json

  # Î≤àÎì§ Î∂ÑÏÑù
  bundle-analysis:
    needs: setup
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}

      - name: Cache dependencies
        uses: actions/cache@v3
        with:
          path: ~/.npm
          key: ${{ needs.setup.outputs.cache-key }}

      - name: Install dependencies
        run: npm ci

      - name: Build and analyze bundle
        run: npm run build:analyze
        env:
          ANALYZE: true

      - name: Upload bundle analysis
        uses: actions/upload-artifact@v3
        with:
          name: bundle-analysis
          path: .next/analyze/

      - name: Check bundle size
        run: |
          node scripts/check-bundle-size.js
          
  # ÏÑ±Îä• ÌÖåÏä§Ìä∏
  performance-tests:
    needs: [setup, unit-tests]
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}

      - name: Cache dependencies
        uses: actions/cache@v3
        with:
          path: ~/.npm
          key: ${{ needs.setup.outputs.cache-key }}

      - name: Install dependencies
        run: npm ci

      - name: Build application
        run: npm run build

      - name: Start application
        run: |
          npm start &
          sleep 30

      - name: Run Lighthouse CI
        run: |
          npm install -g @lhci/cli@0.12.x
          lhci autorun
        env:
          LHCI_GITHUB_APP_TOKEN: ${{ secrets.LHCI_GITHUB_APP_TOKEN }}

      - name: Upload Lighthouse results
        uses: actions/upload-artifact@v3
        if: always()
        with:
          name: lighthouse-results
          path: .lighthouseci/

  # Docker Ïù¥ÎØ∏ÏßÄ ÎπåÎìú
  build-image:
    needs: [code-quality, unit-tests, security-scan]
    runs-on: ubuntu-latest
    if: github.event_name == 'push' || github.event_name == 'release'
    outputs:
      image-digest: ${{ steps.build.outputs.digest }}
      image-tag: ${{ steps.meta.outputs.tags }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Log in to Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}

      - name: Extract metadata
        id: meta
        uses: docker/metadata-action@v5
        with:
          images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}
          tags: |
            type=ref,event=branch
            type=ref,event=pr
            type=semver,pattern={{version}}
            type=semver,pattern={{major}}.{{minor}}
            type=sha,prefix=sha-

      - name: Build and push Docker image
        id: build
        uses: docker/build-push-action@v5
        with:
          context: .
          file: ./Dockerfile
          push: true
          tags: ${{ steps.meta.outputs.tags }}
          labels: ${{ steps.meta.outputs.labels }}
          cache-from: type=gha
          cache-to: type=gha,mode=max
          build-args: |
            NODE_VERSION=${{ env.NODE_VERSION }}
            BUILD_DATE=${{ github.event.head_commit.timestamp }}
            VCS_REF=${{ github.sha }}

  # Í∞úÎ∞ú ÌôòÍ≤Ω Î∞∞Ìè¨
  deploy-dev:
    needs: [build-image, e2e-tests]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/develop' && github.event_name == 'push'
    environment:
      name: development
      url: https://dev.baro-calendar.com
    steps:
      - name: Deploy to development
        run: |
          echo "Deploying to development environment..."
          # Kubernetes/Helm deployment commands

      - name: Run smoke tests
        run: |
          curl -f https://dev.baro-calendar.com/health || exit 1

      - name: Notify deployment
        uses: 8398a7/action-slack@v3
        with:
          status: ${{ job.status }}
          channel: '#deployments'
          text: 'Development deployment completed'
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK }}

  # Ïä§ÌÖåÏù¥Ïßï ÌôòÍ≤Ω Î∞∞Ìè¨
  deploy-staging:
    needs: [build-image, e2e-tests, performance-tests]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main' && github.event_name == 'push'
    environment:
      name: staging
      url: https://staging.baro-calendar.com
    steps:
      - name: Deploy to staging
        run: |
          echo "Deploying to staging environment..."

      - name: Run integration tests
        run: |
          npm run test:integration:staging

      - name: Performance regression check
        run: |
          npm run test:performance:staging

  # ÌîÑÎ°úÎçïÏÖò Î∞∞Ìè¨
  deploy-production:
    needs: [deploy-staging]
    runs-on: ubuntu-latest
    if: github.event_name == 'release'
    environment:
      name: production
      url: https://baro-calendar.com
    steps:
      - name: Deploy to production
        run: |
          echo "Deploying to production environment..."

      - name: Run production health checks
        run: |
          scripts/health-check.sh production

      - name: Update monitoring
        run: |
          scripts/update-monitoring.sh ${{ github.event.release.tag_name }}

      - name: Notify success
        uses: 8398a7/action-slack@v3
        with:
          status: success
          channel: '#general'
          text: 'üöÄ Production deployment successful! Version: ${{ github.event.release.tag_name }}'
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK }}
```

### **2. Dockerfile ÏµúÏ†ÅÌôî**

**Î©ÄÌã∞Ïä§ÌÖåÏù¥ÏßÄ Docker ÎπåÎìú**
```dockerfile
# Dockerfile
# Build stage
FROM node:18-alpine AS builder

WORKDIR /app

# Î≥¥Ïïà ÏóÖÎç∞Ïù¥Ìä∏
RUN apk add --no-cache libc6-compat && \
    apk update && apk upgrade

# ÏùòÏ°¥ÏÑ± ÏÑ§Ïπò (Ï∫êÏãú ÏµúÏ†ÅÌôî)
COPY package*.json ./
RUN npm ci --only=production && npm cache clean --force

# ÏÜåÏä§ ÏΩîÎìú Î≥µÏÇ¨ Î∞è ÎπåÎìú
COPY . .
ARG NODE_ENV=production
ARG BUILD_DATE
ARG VCS_REF
RUN npm run build

# Runtime stage
FROM node:18-alpine AS runner

WORKDIR /app

# ÎπÑÌäπÍ∂å ÏÇ¨Ïö©Ïûê ÏÉùÏÑ±
RUN addgroup -g 1001 -S nodejs && \
    adduser -S nextjs -u 1001

# ÌïÑÏöîÌïú ÌååÏùºÎßå Î≥µÏÇ¨
COPY --from=builder /app/public ./public
COPY --from=builder /app/.next/standalone ./
COPY --from=builder /app/.next/static ./.next/static

# Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ ÎùºÎ≤®
LABEL org.opencontainers.image.title="Baro Calendar"
LABEL org.opencontainers.image.description="Project-based smart calendar management system"
LABEL org.opencontainers.image.created=$BUILD_DATE
LABEL org.opencontainers.image.revision=$VCS_REF
LABEL org.opencontainers.image.licenses="MIT"

# Î≥¥Ïïà ÏÑ§Ï†ï
USER nextjs

EXPOSE 3000

ENV PORT=3000 \
    NODE_ENV=production \
    NEXT_TELEMETRY_DISABLED=1

# Health check
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
    CMD curl -f http://localhost:3000/api/health || exit 1

CMD ["node", "server.js"]
```

### **3. ÌôòÍ≤ΩÎ≥Ñ ÏÑ§Ï†ï Í¥ÄÎ¶¨**

**ÌôòÍ≤Ω ÏÑ§Ï†ï ÌååÏùº**
```typescript
// config/environments.ts
export const environments = {
  development: {
    API_URL: 'http://localhost:3001',
    WS_URL: 'ws://localhost:3001',
    SENTRY_DSN: '',
    ANALYTICS_ID: '',
    LOG_LEVEL: 'debug',
  },
  staging: {
    API_URL: 'https://api-staging.baro-calendar.com',
    WS_URL: 'wss://ws-staging.baro-calendar.com',
    SENTRY_DSN: process.env.SENTRY_DSN_STAGING,
    ANALYTICS_ID: process.env.ANALYTICS_ID_STAGING,
    LOG_LEVEL: 'info',
  },
  production: {
    API_URL: 'https://api.baro-calendar.com',
    WS_URL: 'wss://ws.baro-calendar.com',
    SENTRY_DSN: process.env.SENTRY_DSN_PROD,
    ANALYTICS_ID: process.env.ANALYTICS_ID_PROD,
    LOG_LEVEL: 'error',
  }
}

export const getConfig = () => {
  const env = process.env.NODE_ENV || 'development'
  return environments[env as keyof typeof environments]
}
```

### **4. ÌíàÏßà Í≤åÏù¥Ìä∏ Ïä§ÌÅ¨Î¶ΩÌä∏**

**Î≤àÎì§ ÌÅ¨Í∏∞ Í≤ÄÏ¶ù**
```javascript
// scripts/check-bundle-size.js
const fs = require('fs')
const path = require('path')

const BUNDLE_SIZE_LIMITS = {
  'main': 250 * 1024, // 250KB
  'vendor': 500 * 1024, // 500KB
  'total': 1000 * 1024, // 1MB
}

function getDirectorySize(dir) {
  let size = 0
  const files = fs.readdirSync(dir)
  
  files.forEach(file => {
    const filePath = path.join(dir, file)
    const stats = fs.statSync(filePath)
    
    if (stats.isDirectory()) {
      size += getDirectorySize(filePath)
    } else {
      size += stats.size
    }
  })
  
  return size
}

function checkBundleSize() {
  const buildDir = '.next'
  
  if (!fs.existsSync(buildDir)) {
    console.error('Build directory not found. Run `npm run build` first.')
    process.exit(1)
  }
  
  const totalSize = getDirectorySize(path.join(buildDir, 'static'))
  
  console.log(`Total bundle size: ${(totalSize / 1024).toFixed(2)} KB`)
  
  if (totalSize > BUNDLE_SIZE_LIMITS.total) {
    console.error(
      `‚ùå Bundle size exceeded limit! ` +
      `${(totalSize / 1024).toFixed(2)} KB > ${(BUNDLE_SIZE_LIMITS.total / 1024).toFixed(2)} KB`
    )
    process.exit(1)
  }
  
  console.log('‚úÖ Bundle size check passed!')
}

checkBundleSize()
```

**ÏÑ±Îä• ÌÖåÏä§Ìä∏ Ïä§ÌÅ¨Î¶ΩÌä∏**
```javascript
// scripts/performance-test.js
const lighthouse = require('lighthouse')
const chromeLauncher = require('chrome-launcher')

const PERFORMANCE_THRESHOLDS = {
  performance: 90,
  accessibility: 95,
  'best-practices': 90,
  seo: 90,
  pwa: 80,
}

async function runLighthouse(url) {
  const chrome = await chromeLauncher.launch({chromeFlags: ['--headless']})
  
  const options = {
    logLevel: 'info',
    output: 'json',
    onlyCategories: Object.keys(PERFORMANCE_THRESHOLDS),
    port: chrome.port,
  }
  
  const runnerResult = await lighthouse(url, options)
  await chrome.kill()
  
  return runnerResult.lhr
}

async function checkPerformance(url) {
  console.log(`Running Lighthouse audit on ${url}...`)
  
  const results = await runLighthouse(url)
  const scores = {}
  let failed = false
  
  Object.keys(PERFORMANCE_THRESHOLDS).forEach(category => {
    const score = Math.round(results.categories[category].score * 100)
    const threshold = PERFORMANCE_THRESHOLDS[category]
    
    scores[category] = score
    
    if (score < threshold) {
      console.error(`‚ùå ${category}: ${score} < ${threshold}`)
      failed = true
    } else {
      console.log(`‚úÖ ${category}: ${score} >= ${threshold}`)
    }
  })
  
  if (failed) {
    console.error('Performance test failed!')
    process.exit(1)
  }
  
  console.log('‚úÖ All performance tests passed!')
  return scores
}

const url = process.argv[2] || 'http://localhost:3000'
checkPerformance(url).catch(console.error)
```

### **5. Kubernetes Î∞∞Ìè¨ ÏÑ§Ï†ï**

**Helm Ï∞®Ìä∏**
```yaml
# charts/baro-calendar/values.yaml
replicaCount: 3

image:
  repository: ghcr.io/your-org/baro-calendar
  pullPolicy: IfNotPresent
  tag: ""

service:
  type: ClusterIP
  port: 80
  targetPort: 3000

ingress:
  enabled: true
  className: "nginx"
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
  hosts:
    - host: baro-calendar.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: baro-calendar-tls
      hosts:
        - baro-calendar.com

resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 250m
    memory: 256Mi

autoscaling:
  enabled: true
  minReplicas: 3
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80

nodeSelector: {}
tolerations: []
affinity: {}

env:
  - name: NODE_ENV
    value: "production"
  - name: DATABASE_URL
    valueFrom:
      secretKeyRef:
        name: database-secret
        key: url

probes:
  liveness:
    enabled: true
    path: /api/health
    initialDelaySeconds: 30
    periodSeconds: 10
  readiness:
    enabled: true
    path: /api/ready
    initialDelaySeconds: 5
    periodSeconds: 5
```

### **6. Î™®ÎãàÌÑ∞ÎßÅ Î∞è ÏïåÎ¶º**

**Î∞∞Ìè¨ Î™®ÎãàÌÑ∞ÎßÅ Ïä§ÌÅ¨Î¶ΩÌä∏**
```bash
#!/bin/bash
# scripts/monitor-deployment.sh

ENVIRONMENT=$1
RELEASE_VERSION=$2
SLACK_WEBHOOK=$3

echo "Monitoring deployment for $ENVIRONMENT..."

# Health check
check_health() {
  local url="https://$ENVIRONMENT.baro-calendar.com/api/health"
  local response=$(curl -s -o /dev/null -w "%{http_code}" $url)
  
  if [ $response -eq 200 ]; then
    echo "‚úÖ Health check passed"
    return 0
  else
    echo "‚ùå Health check failed: $response"
    return 1
  fi
}

# Performance check
check_performance() {
  local url="https://$ENVIRONMENT.baro-calendar.com"
  node scripts/performance-test.js $url
}

# Database connectivity
check_database() {
  # Add database connectivity check
  echo "‚úÖ Database connectivity check passed"
}

# Send notification
send_notification() {
  local status=$1
  local message=$2
  
  if [ -n "$SLACK_WEBHOOK" ]; then
    curl -X POST -H 'Content-type: application/json' \
      --data "{\"text\":\"$status Deployment $message for $ENVIRONMENT (v$RELEASE_VERSION)\"}" \
      $SLACK_WEBHOOK
  fi
}

# Main monitoring loop
main() {
  echo "Starting post-deployment monitoring..."
  
  # Wait for deployment to settle
  sleep 30
  
  # Run checks
  if check_health && check_performance && check_database; then
    echo "üéâ Deployment monitoring completed successfully!"
    send_notification "‚úÖ" "completed successfully"
    exit 0
  else
    echo "‚ùå Deployment monitoring failed!"
    send_notification "‚ùå" "failed"
    exit 1
  fi
}

main
```

### **7. Î°§Î∞± Ïä§ÌÅ¨Î¶ΩÌä∏**

**ÏûêÎèô Î°§Î∞± ÏãúÏä§ÌÖú**
```bash
#!/bin/bash
# scripts/rollback.sh

ENVIRONMENT=$1
PREVIOUS_VERSION=$2

echo "Rolling back $ENVIRONMENT to version $PREVIOUS_VERSION..."

# Kubernetes rollback
kubectl rollout undo deployment/baro-calendar-$ENVIRONMENT --to-revision=$PREVIOUS_VERSION

# Wait for rollback to complete
kubectl rollout status deployment/baro-calendar-$ENVIRONMENT --timeout=300s

# Verify rollback
if check_health $ENVIRONMENT; then
  echo "‚úÖ Rollback completed successfully"
  send_slack_notification "üîÑ Rollback to v$PREVIOUS_VERSION completed for $ENVIRONMENT"
else
  echo "‚ùå Rollback failed"
  send_slack_notification "‚ùå Rollback failed for $ENVIRONMENT"
  exit 1
fi
```

---

## üìä **ÌíàÏßà Î©îÌä∏Î¶≠ Î∞è KPI**

### **CI/CD Î©îÌä∏Î¶≠**
- ÎπåÎìú ÏÑ±Í≥µÎ•†: 95% Ïù¥ÏÉÅ
- ÌèâÍ∑† ÎπåÎìú ÏãúÍ∞Ñ: 10Î∂Ñ Ïù¥Ìïò
- Î∞∞Ìè¨ ÎπàÎèÑ: Ï£ºÎãπ 5Ìöå Ïù¥ÏÉÅ
- ÌèâÍ∑† Î∞∞Ìè¨ ÏãúÍ∞Ñ: 5Î∂Ñ Ïù¥Ìïò
- Î°§Î∞± ÎπàÎèÑ: 5% Ïù¥Ìïò

### **ÏΩîÎìú ÌíàÏßà Î©îÌä∏Î¶≠**
- ÌÖåÏä§Ìä∏ Ïª§Î≤ÑÎ¶¨ÏßÄ: 90% Ïù¥ÏÉÅ
- ÏΩîÎìú Ï§ëÎ≥µÎèÑ: 3% Ïù¥Ìïò
- Î¶∞Ìä∏ ÏóêÎü¨: 0Í∞ú
- Î≥¥Ïïà Ï∑®ÏïΩÏ†ê: Critical 0Í∞ú, High 2Í∞ú Ïù¥Ìïò

---

## ‚úÖ **Definition of Done**

### **Í∏∞Îä• ÏöîÍµ¨ÏÇ¨Ìï≠**
- [ ] GitHub Actions CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ Íµ¨ÌòÑ
- [ ] Îã§Ï§ë ÌôòÍ≤Ω Î∞∞Ìè¨ ÏûêÎèôÌôî (dev/staging/prod)
- [ ] ÏûêÎèôÌôîÎêú ÌÖåÏä§Ìä∏ Î∞è ÌíàÏßà Í≤ÄÏ¶ù
- [ ] Ïª®ÌÖåÏù¥ÎÑà Í∏∞Î∞ò Î∞∞Ìè¨
- [ ] Î°§Î∞± Î©îÏª§ÎãàÏ¶ò

### **Í∏∞Ïà† ÏöîÍµ¨ÏÇ¨Ìï≠**
- [ ] Docker Î©ÄÌã∞Ïä§ÌÖåÏù¥ÏßÄ ÎπåÎìú
- [ ] Kubernetes Helm Ï∞®Ìä∏
- [ ] ÌôòÍ≤ΩÎ≥Ñ ÏÑ§Ï†ï Í¥ÄÎ¶¨
- [ ] Î≥¥Ïïà Ïä§Ï∫î ÌÜµÌï©

### **ÌíàÏßà ÏöîÍµ¨ÏÇ¨Ìï≠**
- [ ] Î™®Îì† ÌÖåÏä§Ìä∏ ÌÜµÍ≥º ÌõÑ Î∞∞Ìè¨
- [ ] ÏÑ±Îä• ÏûÑÍ≥ÑÍ∞í Í≤ÄÏ¶ù
- [ ] Î≤àÎì§ ÌÅ¨Í∏∞ Ï†úÌïú Í≤ÄÏ¶ù
- [ ] Î≥¥Ïïà Ï∑®ÏïΩÏ†ê Ïä§Ï∫î

### **Î™®ÎãàÌÑ∞ÎßÅ ÏöîÍµ¨ÏÇ¨Ìï≠**
- [ ] Î∞∞Ìè¨ ÏÉÅÌÉú ÏïåÎ¶º
- [ ] ÏÑ±Îä• Î©îÌä∏Î¶≠ ÏàòÏßë
- [ ] ÏóêÎü¨Ïú® Î™®ÎãàÌÑ∞ÎßÅ
- [ ] ÏûêÎèô Î°§Î∞± Ìä∏Î¶¨Í±∞

---

## üìö **Í¥ÄÎ†® Î¨∏ÏÑú Ï∞∏Ï°∞**

- [22. CI Pipeline & Performance](../ui-architecture/22-ci-pipeline-performance.md)
- [23. Git Workflow Process](../ui-architecture/23-git-workflow-process.md)
- [21. Observability & Monitoring](../ui-architecture/21-observability-monitoring.md)

---

**Ïù¥ Ïä§ÌÜ†Î¶¨Îäî Î∞îÎ°úÏ∫òÎ¶∞ÎçîÏùò ÏôÑÏ†ÑÌïú CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ Íµ¨ÌòÑÏùÑ ÏúÑÌïú Í∏∞Ïà† Í∞ÄÏù¥ÎìúÏûÖÎãàÎã§. ÏïàÏ†ïÏ†ÅÏù¥Í≥† Ïã†Î¢∞Ìï† Ïàò ÏûàÎäî Î∞∞Ìè¨ ÏûêÎèôÌôîÎ•º ÌÜµÌï¥ Í∞úÎ∞ú ÏÉùÏÇ∞ÏÑ±ÏùÑ Í∑πÎåÄÌôîÌïòÍ≥† ÏÑúÎπÑÏä§ ÌíàÏßàÏùÑ Î≥¥Ïû•Ìï©ÎãàÎã§.**